<?xml version="1.0" encoding="utf-8"?>
<extension type="plugin" group="system" method="upgrade" version="5.0">
    <name>PLG_SYSTEM_ALTOIMPORTER</name>
    <author>Russell English</author>
    <creationDate>2025-04-29</creationDate>
    <copyright>Copyright (C) 2025 Storm Web Design</copyright>
    <license>GPL-2.0-or-later</license>
    <version>1.0.0</version>
    <description>PLG_SYSTEM_ALTOIMPORTER_DESC</description>
    <namespace path="src">Joomla\Plugin\System\Altoimporter</namespace>

    <scriptfile>script.php</scriptfile>

    <files>
        <filename plugin="altoimporter">altoimporter.php</filename>
        <filename>script.php</filename>
        <folder>src</folder>
    </files>

    <languages>
        <language tag="en-GB">language/en-GB/plg_system_altoimporter.ini</language>
        <language tag="en-GB">language/en-GB/plg_system_altoimporter.sys.ini</language>
    </languages>

    <config>
        <fields name="params">
            <fieldset name="basic">
                <field
                    name="api_key"
                    type="text"
                    label="PLG_SYSTEM_ALTOIMPORTER_API_KEY"
                    description="PLG_SYSTEM_ALTOIMPORTER_API_KEY_DESC"
                    required="true"
                />
                <field
                    name="username"
                    type="text"
                    label="PLG_SYSTEM_ALTOIMPORTER_USERNAME"
                    description="PLG_SYSTEM_ALTOIMPORTER_USERNAME_DESC"
                    required="true"
                />
                <field
                    name="password"
                    type="password"
                    label="PLG_SYSTEM_ALTOIMPORTER_PASSWORD"
                    description="PLG_SYSTEM_ALTOIMPORTER_PASSWORD_DESC"
                    required="true"
                />
                <field
                    name="manual_import_button"
                    type="button"
                    label="PLG_SYSTEM_ALTOIMPORTER_MANUAL_IMPORT"
                    description="PLG_SYSTEM_ALTOIMPORTER_MANUAL_IMPORT_DESC"
                    onclick="Joomla.ajax('index.php?option=com_ajax&plugin=altoimporter&group=system&format=json&task=doImport', {}, {success: function(response){ alert(response.data.message); }, error: function(err){ alert('Import failed'); }});"
                />
            </fieldset>
        </fields>
    </config>

    <tasks>
        <task
            group="system"
            class="Joomla\Plugin\System\Altoimporter\Task\ImportTask"
            name="PLG_SYSTEM_ALTOIMPORTER_TASK_IMPORT"
            title="PLG_SYSTEM_ALTOIMPORTER_TASK_IMPORT_TITLE"
            description="PLG_SYSTEM_ALTOIMPORTER_TASK_IMPORT_DESC"
        />
    </tasks>
</extension>
